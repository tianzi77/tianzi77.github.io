<!doctype html>
<html lang="zh-cn">

<head>
    <meta charset="utf-8" />
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" name="viewport">
    <title>授权审批 - 携程商旅APP</title>
    <meta name="description" content="" />
    <meta name="keywords" content="" />
    <!-- 静态资源引用编译后路径 -->
    <link rel="stylesheet" href="./assets/style/video.css?20180316">
</head>

<body>
    <div class="wrapper">
        <div class="container content-container" style="display:none;">
            <span class="btn-set1" onclick="refuse()"></span>
            <!-- 拒绝 -->
            <span class="btn-set2" onclick="passed()"></span>
            <!-- 通过 -->
        </div>
        <!-- 视频 -->
        <div class="container video-container">
            <video poster="https://qnm.res.netease.com/m/zt/dzdl/images/video-poster.png" id="video" preload="auto" x5-video-player-type="h5" x5-video-player-fullscreen="true" x5-video-orientation="portraint" x-webkit-airplay="true" webkit-playsinline="true" playsinline="true">
            <source src="https://qnm.res.netease.com/m/zt/dzdl/source/v.mp4" type="video/mp4" />
          </video>
        </div>
    </div>

    <script type="text/javascript" src="./assets/js/zepto.min.js"></script>
    <script type="text/javascript" src="./assets/js/crem.js"></script>
    <script>
        /*
                                                                        var video = document.getElementById("videoPlayer");
                                                                        //自动暂停
                                                                        function autoPause() {
                                                                            var sec = Math.round(video.currentTime);
                                                                            //console.log(sec);
                                                                            if (sec == 25) {
                                                                                console.log(sec + 's');
                                                                                video.pause();
                                                                                $(".mask-layer").show();
                                                                            } else if (sec == 44) {
                                                                                console.log(sec + 's');
                                                                                video.pause();
                                                                                $(".mask-layer").show();
                                                                            }
                                                                        }
                                                        */


        var timePoint = {
            step1: 27.667334,
            step2: 45.880411,
            stopbgm: 59.46478,
        }
        var $win = $(window);
        var stepTarget = 'step1';
        var $video = $('#video');
        var video = $video.get(0);
        var btn1 = $('#btn-set1');
        var btn2 = $('#btn-set2');
        var mask = $('.content-container');

        //拒绝
        function refuse() {
            video.currentTime = 46; // 秒，设置下一个播放点
            video.play();
            mask.hide();
        }

        //通过
        function passed() {
            video.currentTime = 28;
            video.play();
            mask.hide();
        }

        function playVideo() {
            video.play();
        }
        playVideo();

        function pauseVideo() {
            video.pause();
        }
        $win.on('scroll.page', function(e) {
            e.preventDefault();
        }).on('touchmove.page', function(e) {
            e.preventDefault();
        });
        $video.on('canplay', function() {
            // alert('canplay');
        }).on('timeupdate', function() {
            var vtime = video.currentTime;
            console.log('当前播放进度：' + video.currentTime);
            if (vtime = timePoint.step1 && stepTarget == 'step1') {
                //alert(1)
            }
            /*
            if (vtime >= timePoint.step1 && stepTarget == 'step1') {
                pauseVideo();
                mask.show();

            } else if (vtime >= timePoint.step2 && stepTarget == 'step2') {
                pauseVideo();
                mask.show();

            } else if (vtime >= timePoint.stopbgm && stepTarget == 'stopbgm') {
                stepTarget = 'over';
            }
            */
            var sec = Math.round(video.currentTime);
            if (sec == '25') {
                //console.log(sec + 's');
                video.pause();
                mask.show();
            } else if (sec == '44') {
                // console.log(sec + 's');
                video.pause();
                mask.show();
            }
        }).on('ended', function() {
            '演示结束'
            //$pageEnd.fadeIn();
        });
    </script>
</body>

</html>